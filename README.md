# PCA9956 sample Code for Arduino
I2C controlled LED driver PCA9956's sample code for Arduino.
i2cLEDドライバー、PCA9956のArduino用サンプルコードです。24チャンネル制御できるとても便利なICなのですが、サンプルコードが全然見つからず、データシートもとても分かりにくいものでしたので、ご参考になればと思います。スイッチサイエンス製の評価ボードにて動作を確認しています。i2cアドレスは起動時に自動スキャンするようにしていますが、アドレス設定ピン3本すべてオープン（未接続）の場合は、Ox3Fです。他にもデバイスを接続する場合はDEV_ADDRESSのコメントを消してアドレスを設定してください。（データシート上では0x7Eと表記がありますが、対応するHEXの欄の0x3Fを設定する必要があります。）
[デバイスのデータシートはこちら](https://www.nxp.com/docs/en/data-sheet/PCA9956B.pdf)
[Switch Scienceの商品ページ](https://www.switch-science.com/catalog/2677/)

簡単ですがいかに手順を記載します。
1．i2c及び電源を接続
  Arduino   PCA9956
  5V        VDD
  GND       GND
  SDA       SDA
  SCL       SCL
2. i2c用プルアップ抵抗をドライバ側のSDA SCLとVCC間に接続（スイッチサイエンス製の基板にはプルアップ抵抗がついていないので注意！4.7kOhmとかでOK）
3. スケッチをアップロード

プログラムを見て頂ければわかりますが、ON/OFF制御のみの場合、設定手順は以下となります。
1. MODE1(Ox00)レジスタを設定
2. LEDOUT0-5(0x02 - 0x7) ドライバ出力状態設定、該当するフラグにビットを立てる。データシート17ページ参照
3. IREF0 - 23(0x22 - 0x39)出力電流設定
この手順はデータシートの**どこにも**書いておらずここにたどり着く前に挫折してしまう人が多いようです。
ちなみに私はアマゾンの評価に載っていたコメントでRaspiで設定した人の手順を見てようやく理解しました（ありがとうございます！）。
